# 鸿蒙版快速启动指南

## 一、准备工作

### 1. 启动后端服务

```bash
# 进入 Web 版后端目录
cd /Users/csc/Desktop/ht/study/yishiting/backend

# 启动服务（如果还没启动）
npm run dev
```

确认看到：`🚀 Server running on http://localhost:3000`

### 2. 配置网络地址（真机调试必须）

如果使用真机调试，需要修改 API 地址：

**文件位置**：`entry/src/main/ets/services/ChatService.ets`

```typescript
// 第 7 行，将 localhost 改为你的电脑 IP
private baseUrl: string = 'http://192.168.1.100:3000'; // 改成你的 IP
```

**如何查看电脑 IP？**
- Mac: 系统设置 → 网络 → Wi-Fi → 详细信息
- Windows: 命令行输入 `ipconfig`

### 3. 确保手机和电脑在同一 Wi-Fi

真机调试时，手机和电脑必须连接同一个 Wi-Fi 网络。

## 二、运行应用

### 使用 DevEco Studio

1. 打开项目（yishiting-hm 文件夹）
2. 等待项目索引完成
3. 连接鸿蒙设备或启动模拟器
4. 点击顶部的运行按钮（绿色三角形）

### 使用命令行

```bash
cd yishiting-hm
hvigorw assembleHap
```

## 三、测试功能

### 1. 选择模式

启动后会看到两个模式卡片：
- 👑 皇帝模式
- 🏔️ 西游模式

点击任意一个进入聊天页面。

### 2. 开始对话

输入你的问题，例如：
- "我在公司干得不爽，但又暂时跳槽无门"
- "要不要跳槽，很纠结"
- "感觉工作没意义，很迷茫"

### 3. 观察效果

- 多个角色会轮流发言
- 每个角色有自己的头像和名字
- 内容实时流式显示
- 最后会有总结和待办事项

## 四、常见问题排查

### 问题 1：无法连接服务器

**症状**：点击发送后一直加载，或显示"网络请求失败"

**解决方案**：
1. 确认后端服务正在运行
2. 检查 IP 地址是否正确（真机调试）
3. 确认手机和电脑在同一 Wi-Fi
4. 检查防火墙是否阻止了 3000 端口

**测试后端是否正常**：
```bash
# 在电脑上测试
curl http://localhost:3000/api/chat/stream
```

### 问题 2：消息显示不完整

**症状**：只显示部分内容就停止了

**解决方案**：
1. 检查网络稳定性
2. 查看 DevEco Studio 的日志输出
3. 确认后端没有报错

### 问题 3：编译错误

**症状**：DevEco Studio 报红线或编译失败

**解决方案**：
1. 清理项目：Build → Clean Project
2. 重新构建：Build → Rebuild Project
3. 检查 SDK 版本是否正确（需要 API 12）

### 问题 4：模拟器无法连接

**症状**：模拟器可以运行，但无法连接后端

**解决方案**：
- 模拟器使用 `http://localhost:3000` 即可
- 不需要修改 IP 地址

## 五、开发调试技巧

### 查看日志

在 DevEco Studio 底部的 Log 窗口可以看到：
- 网络请求日志
- 错误信息
- console.log 输出

### 热重载

修改代码后：
- 保存文件
- 点击运行按钮
- 应用会自动重新安装

### 断点调试

1. 在代码行号左侧点击设置断点
2. 使用 Debug 模式运行
3. 触发相应功能后会暂停在断点处

## 六、与 Web 版对比测试

可以同时运行 Web 版和鸿蒙版，对比功能：

**Web 版**：
```bash
cd /Users/csc/Desktop/ht/study/yishiting/frontend
npm run dev
# 访问 http://localhost:5173
```

**鸿蒙版**：
- 在设备上运行

两个版本应该有完全一致的功能和体验。

## 七、下一步

功能正常后，可以考虑：

1. **优化 UI**：调整颜色、字体、间距
2. **添加功能**：消息复制、分享、历史记录
3. **性能优化**：减少重绘、优化列表渲染
4. **打包发布**：生成 HAP 包用于分发

## 需要帮助？

如果遇到问题：
1. 查看 DevEco Studio 的 Log 输出
2. 检查后端服务日志
3. 确认网络配置正确
4. 参考 README_HARMONYOS.md 详细文档
